{"ast":null,"code":"import _regeneratorRuntime from \"/home/devbox/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/devbox/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nimport { login, register } from '@/api/user';\nexport default {\n  __name: 'index',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var router = useRouter();\n    var formRef = ref(null);\n    var loading = ref(false);\n    var isLogin = ref(true);\n    var form = reactive({\n      username: '',\n      password: ''\n    });\n    var rules = {\n      username: [{\n        required: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 20,\n        message: '长度在 3 到 20 个字符',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 6,\n        max: 20,\n        message: '长度在 6 到 20 个字符',\n        trigger: 'blur'\n      }]\n    };\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var api, res;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (formRef.value) {\n                _context.next = 2;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 2:\n              _context.prev = 2;\n              _context.next = 5;\n              return formRef.value.validate();\n            case 5:\n              loading.value = true;\n              api = isLogin.value ? login : register;\n              _context.next = 9;\n              return api(form);\n            case 9:\n              res = _context.sent;\n              if (isLogin.value) {\n                // 保存登录信息\n                localStorage.setItem('token', res.Data.token);\n                localStorage.setItem('username', form.username);\n                localStorage.setItem('userRole', res.Data.role);\n                ElMessage.success('登录成功');\n                router.push('/');\n              } else {\n                ElMessage.success('注册成功');\n                isLogin.value = true;\n              }\n              _context.next = 16;\n              break;\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](2);\n              console.error('提交失败:', _context.t0);\n            case 16:\n              _context.prev = 16;\n              loading.value = false;\n              return _context.finish(16);\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[2, 13, 16, 19]]);\n      }));\n      return function handleSubmit() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var toggleMode = function toggleMode() {\n      isLogin.value = !isLogin.value;\n      form.username = '';\n      form.password = '';\n      if (formRef.value) {\n        formRef.value.clearValidate();\n      }\n    };\n    var __returned__ = {\n      router: router,\n      formRef: formRef,\n      loading: loading,\n      isLogin: isLogin,\n      form: form,\n      rules: rules,\n      handleSubmit: handleSubmit,\n      toggleMode: toggleMode,\n      ref: ref,\n      reactive: reactive,\n      get useRouter() {\n        return useRouter;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get login() {\n        return login;\n      },\n      get register() {\n        return register;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","useRouter","ElMessage","login","register","router","formRef","loading","isLogin","form","username","password","rules","required","message","trigger","min","max","handleSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","api","res","wrap","_callee$","_context","prev","next","value","abrupt","validate","sent","localStorage","setItem","Data","token","role","success","push","t0","console","error","finish","stop","apply","arguments","toggleMode","clearValidate"],"sources":["/home/devbox/project/src/views/login/index.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-card class=\"login-card\">\n      <template #header>\n        <h2 class=\"card-title\">{{ isLogin ? '登录' : '注册' }}</h2>\n      </template>\n      \n      <el-form\n        ref=\"formRef\"\n        :model=\"form\"\n        :rules=\"rules\"\n        label-width=\"80px\"\n        @keyup.enter=\"handleSubmit\"\n      >\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"form.username\" placeholder=\"请输入用户名\" />\n        </el-form-item>\n        \n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input\n            v-model=\"form.password\"\n            type=\"password\"\n            placeholder=\"请输入密码\"\n            show-password\n          />\n        </el-form-item>\n\n        <el-form-item>\n          <el-button type=\"primary\" :loading=\"loading\" @click=\"handleSubmit\">\n            {{ isLogin ? '登录' : '注册' }}\n          </el-button>\n          <el-button @click=\"toggleMode\">\n            {{ isLogin ? '去注册' : '去登录' }}\n          </el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nimport { login, register } from '@/api/user';\n\nconst router = useRouter();\nconst formRef = ref(null);\nconst loading = ref(false);\nconst isLogin = ref(true);\n\nconst form = reactive({\n  username: '',\n  password: ''\n});\n\nconst rules = {\n  username: [\n    { required: true, message: '请输入用户名', trigger: 'blur' },\n    { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }\n  ],\n  password: [\n    { required: true, message: '请输入密码', trigger: 'blur' },\n    { min: 6, max: 20, message: '长度在 6 到 20 个字符', trigger: 'blur' }\n  ]\n};\n\nconst handleSubmit = async () => {\n  if (!formRef.value) return;\n  \n  try {\n    await formRef.value.validate();\n    loading.value = true;\n    \n    const api = isLogin.value ? login : register;\n    const res = await api(form);\n    \n    if (isLogin.value) {\n      // 保存登录信息\n      localStorage.setItem('token', res.Data.token);\n      localStorage.setItem('username', form.username);\n      localStorage.setItem('userRole', res.Data.role);\n      \n      ElMessage.success('登录成功');\n      router.push('/');\n    } else {\n      ElMessage.success('注册成功');\n      isLogin.value = true;\n    }\n  } catch (error) {\n    console.error('提交失败:', error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst toggleMode = () => {\n  isLogin.value = !isLogin.value;\n  form.username = '';\n  form.password = '';\n  if (formRef.value) {\n    formRef.value.clearValidate();\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.login-container {\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f0f2f5;\n  \n  .login-card {\n    width: 400px;\n    \n    .card-title {\n      text-align: center;\n      margin: 0;\n    }\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}